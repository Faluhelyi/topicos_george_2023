D20 <- diag(imgg.svd$d[1:20])
img_gray20 <- U20 %*% D20 %*% t(V20)
imageShow(img_gray20)
((tr(D20)/tr(D))-1) * 100
rankMatrix(img_gray20)[1]
mean((img_gray-img_gray20)^2)
U30 <- as.matrix(U[,1:30])
V30 <- as.matrix(V[,1:30])
D30 <- diag(imgg.svd$d[1:30])
img_gray30 <- U30 %*% D30 %*% t(V30)
imageShow(img_gray30)
((tr(D30)/tr(D))-1) * 100
rankMatrix(img_gray30)[1]
mean((img_gray-img_gray30)^2)
U40 <- as.matrix(U[,1:40])
V40 <- as.matrix(V[,1:40])
D40 <- diag(imgg.svd$d[1:40])
img_gray40 <- U40 %*% D40 %*% t(V40)
imageShow(img_gray40)
title("teste")
((tr(D40)/tr(D))-1) * 100
rankMatrix(img_gray40)[1]
mean((img_gray-img_gray40)^2)
((tr(D30)/tr(D))-1) * 100
library(psych)
library(OpenImageR)
library(Matrix)
#foto ="C:/Users/Igor/Desktop/topicos_george_2023/git_repo/lista2/imag1.jpg"
foto ="C:/Users/Igor/Desktop/topicos_george_2023/git_repo/lista2/imag2.jpg"
img <- readImage(foto)
dim(img)
imageShow(img)
img_gray <- rgb_2gray(img) # ERROR!!!
img3 <- img[,,1:3]
imageShow(img3)
dim(img3)
img_gray <- rgb_2gray(img3)
dim(img_gray)
imageShow(img_gray)
### Aplicando SVD na Imagem
imgg.svd <- svd(img_gray)
imgg.svd$d
D <- diag(imgg.svd$d)
dim(D)
U <- imgg.svd$u
V <- imgg.svd$v
plot(1:length(imgg.svd$d), imgg.svd$d)
abline(v=c(5,10,20,40))
plot(1:length(imgg.svd$d), imgg.svd$d,
xlim = c(1,60))
abline(v=c(5,10,20,40))
plot(1:length(imgg.svd$d), imgg.svd$d,
xlim = c(10,80),ylim = c(0,30))
abline(v=c(20,40,60))
### Aproximacoes
U5 <- as.matrix(U[,1:5])
V5 <- as.matrix(V[,1:5])
D5 <- diag(imgg.svd$d[1:5])
img_gray5 <- U5 %*% D5 %*% t(V5)
imageShow(img_gray5)
((tr(D5)/tr(D))-1) * 100
rankMatrix(img_gray5)[1]
mean((img_gray-img_gray5)^2)
U10 <- as.matrix(U[,1:10])
V10 <- as.matrix(V[,1:10])
D10 <- diag(imgg.svd$d[1:10])
img_gray10 <- U10 %*% D10 %*% t(V10)
imageShow(img_gray10)
((tr(D10)/tr(D))-1) * 100
rankMatrix(img_gray10)[1]
mean((img_gray-img_gray10)^2)
U20 <- as.matrix(U[,1:20])
V20 <- as.matrix(V[,1:20])
D20 <- diag(imgg.svd$d[1:20])
img_gray20 <- U20 %*% D20 %*% t(V20)
imageShow(img_gray20)
((tr(D20)/tr(D))-1) * 100
rankMatrix(img_gray20)[1]
mean((img_gray-img_gray20)^2)
U30 <- as.matrix(U[,1:30])
V30 <- as.matrix(V[,1:30])
D30 <- diag(imgg.svd$d[1:30])
img_gray30 <- U30 %*% D30 %*% t(V30)
imageShow(img_gray30)
((tr(D30)/tr(D))-1) * 100
rankMatrix(img_gray30)[1]
mean((img_gray-img_gray30)^2)
U40 <- as.matrix(U[,1:40])
V40 <- as.matrix(V[,1:40])
D40 <- diag(imgg.svd$d[1:40])
img_gray40 <- U40 %*% D40 %*% t(V40)
imageShow(img_gray40)
title("teste")
((tr(D40)/tr(D))-1) * 100
rankMatrix(img_gray40)[1]
mean((img_gray-img_gray40)^2)
U60 <- as.matrix(U[,1:60])
V60 <- as.matrix(V[,1:60])
D60 <- diag(imgg.svd$d[1:60])
img_gray60 <- U60 %*% D60 %*% t(V60)
imageShow(img_gray60)
((tr(D60)/tr(D))-1 )* 100
rankMatrix(img_gray60)[1]
mean((img_gray-img_gray60)^2)
foto ="C:/Users/Igor/Desktop/topicos_george_2023/git_repo/lista2/imag1.jpg"
#foto ="C:/Users/Igor/Desktop/topicos_george_2023/git_repo/lista2/imag2.jpg"
img <- readImage(foto)
dim(img)
imageShow(img)
img_gray <- rgb_2gray(img) # ERROR!!!
img3 <- img[,,1:3]
imageShow(img3)
dim(img3)
img_gray <- rgb_2gray(img3)
dim(img_gray)
imageShow(img_gray)
### Aplicando SVD na Imagem
imgg.svd <- svd(img_gray)
imgg.svd$d
D <- diag(imgg.svd$d)
dim(D)
U <- imgg.svd$u
V <- imgg.svd$v
plot(1:length(imgg.svd$d), imgg.svd$d)
abline(v=c(5,10,20,40))
plot(1:length(imgg.svd$d), imgg.svd$d,
xlim = c(1,60))
abline(v=c(5,10,20,40))
plot(1:length(imgg.svd$d), imgg.svd$d,
xlim = c(10,80),ylim = c(0,30))
abline(v=c(20,40,60))
### Aproximacoes
U5 <- as.matrix(U[,1:5])
V5 <- as.matrix(V[,1:5])
D5 <- diag(imgg.svd$d[1:5])
img_gray5 <- U5 %*% D5 %*% t(V5)
imageShow(img_gray5)
((tr(D5)/tr(D))-1) * 100
rankMatrix(img_gray5)[1]
mean((img_gray-img_gray5)^2)
U10 <- as.matrix(U[,1:10])
V10 <- as.matrix(V[,1:10])
D10 <- diag(imgg.svd$d[1:10])
img_gray10 <- U10 %*% D10 %*% t(V10)
imageShow(img_gray10)
((tr(D10)/tr(D))-1) * 100
rankMatrix(img_gray10)[1]
mean((img_gray-img_gray10)^2)
U20 <- as.matrix(U[,1:20])
V20 <- as.matrix(V[,1:20])
D20 <- diag(imgg.svd$d[1:20])
img_gray20 <- U20 %*% D20 %*% t(V20)
imageShow(img_gray20)
((tr(D20)/tr(D))-1) * 100
rankMatrix(img_gray20)[1]
mean((img_gray-img_gray20)^2)
U30 <- as.matrix(U[,1:30])
V30 <- as.matrix(V[,1:30])
D30 <- diag(imgg.svd$d[1:30])
img_gray30 <- U30 %*% D30 %*% t(V30)
imageShow(img_gray30)
((tr(D30)/tr(D))-1) * 100
rankMatrix(img_gray30)[1]
mean((img_gray-img_gray30)^2)
U40 <- as.matrix(U[,1:40])
V40 <- as.matrix(V[,1:40])
D40 <- diag(imgg.svd$d[1:40])
img_gray40 <- U40 %*% D40 %*% t(V40)
imageShow(img_gray40)
title("teste")
((tr(D40)/tr(D))-1) * 100
rankMatrix(img_gray40)[1]
mean((img_gray-img_gray40)^2)
qf(0.05, 5, (5000-5-1))
setwd("C:/Users/Igor/Desktop/topicos_george_2023/lista4")
set.seed(180122207)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
cor(x1,x2)
plot(x2~x1)
set.seed(180122207)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
#$Y = 2 + 2x_1 + 0.3x_2 + \epsilon$, where $\epsilon$ is a N(0,1) variable.
#$\beta_0=2$, $\beta_1=2$, $\beta_2=0.3$
cor(x1,x2)
plot(x2~x1)
lm.fit9 = lm(y~x1+x2)
summary(lm.fit9)
set.seed(180122207)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
#$Y = 2 + 2x_1 + 0.3x_2 + \epsilon$, where $\epsilon$ is a N(0,1) variable.
#$\beta_0=2$, $\beta_1=2$, $\beta_2=0.3$
cor(x1,x2)
plot(x2~x1)
lm.fit9 = lm(y~x1+x2)
summary(lm.fit9)
setwd("C:/Users/Igor/Desktop/topicos_george_2023/lista4")
setwd("C:/Users/Igor/Desktop/topicos_george_2023/git_repo/lista4")
setwd("C:/Users/Igor/Desktop/topicos_george_2023/git_repo/lista4")
setwd("C:/Users/Igor/Desktop/topicos_george_2023/git_repo/lista4")
########################################################
## Exercício 14 do Capítulo 3 de James et al. (2021). ##
########################################################
#a,b e c
set.seed(180122207)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
#$Y = 2 + 2x_1 + 0.3x_2 + \epsilon$, where $\epsilon$ is a N(0,1) variable.
#$\beta_0=2$, $\beta_1=2$, $\beta_2=0.3$
cor(x1,x2)
plot(x2~x1)
lm.fit9 = lm(y~x1+x2)
summary(lm.fit9)
lm.fit10 = lm(y~x1)
summary(lm.fit10)
lm.fit10 = lm(y~x1)
summary(lm.fit10)
lm.fit9 = lm(y~x1+x2)
summary(lm.fit9)
lm.fit10 = lm(y~x1)
summary(lm.fit10)
lm.fit11 = lm(y~x2)
summary(lm.fit11)
cor(x1,x2)
lm.fit9 = lm(y~x1+x2)
summary(lm.fit9)
lm.fit9 = lm(y~x1+x2)
summary(lm.fit9)
lm.fit10 = lm(y~x1)
summary(lm.fit10)
lm.fit11 = lm(y~x2)
summary(lm.fit11)
x1=c(x1 , 0.1)
x2=c(x2 , 0.8)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=0.8, labels="new-obs", pos=4, cex=.7, col="blue")
par(mfrow=c(2,2))
plot(lm.fit9_g)
par(mfrow=c(2,2))
plot(lm.fit10_g)
par(mfrow=c(2,2))
plot(lm.fit11_g)
x1=c(x1 , 0.1)
x2=c(x2 , 0.8)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=0.8, labels="new-obs", pos=4, cex=.7, col="blue")
par(mfrow=c(2,2))
plot(lm.fit9_g)
par(mfrow=c(2,2))
plot(lm.fit10_g)
par(mfrow=c(2,2))
plot(lm.fit11_g)
x1=c(x1 , 0.1)
x2=c(x2 , 0.8)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=0.8, labels="new-obs", pos=4, cex=.7, col="blue")
par(mfrow=c(2,2))
plot(lm.fit9_g)
par(mfrow=c(2,2))
plot(lm.fit10_g)
par(mfrow=c(2,2))
plot(lm.fit11_g)
set.seed(1)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
cor(x1,x2)
plot(x2~x1)
lm.fit9 = lm(y~x1+x2)
summary(lm.fit9)
set.seed(180122207)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
#$Y = 2 + 2x_1 + 0.3x_2 + \epsilon$, where $\epsilon$ is a N(0,1) variable.
#$\beta_0=2$, $\beta_1=2$, $\beta_2=0.3$
cor(x1,x2)
plot(x2~x1)
lm.fit9 = lm(y~x1+x2)
summary(lm.fit9)
set.seed(1)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
x1=c(x1 , 0.1)
x2=c(x2 , 0.8)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=0.8, labels="new-obs", pos=4, cex=.7, col="blue")
par(mfrow=c(2,2))
plot(lm.fit9_g)
par(mfrow=c(2,2))
plot(lm.fit10_g)
par(mfrow=c(2,2))
plot(lm.fit11_g)
set.seed(180122207)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
cor(x1,x2)
plot(x2~x1)
lm.fit9 = lm(y~x1+x2)
summary(lm.fit9)
lm.fit11 = lm(y~x2)
summary(lm.fit11)
# g
x1=c(x1 , 0.1)
x2=c(x2 , 0.8)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=0.8, labels="new-obs", pos=4, cex=.7, col="blue")
x1=c(x1 , 0.1)
x2=c(x2 , 1)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=0.8, labels="new-obs", pos=4, cex=.7, col="blue")
set.seed(180122207)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
x1=c(x1 , 0.1)
x2=c(x2 , 1.5)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=0.8, labels="new-obs", pos=4, cex=.7, col="blue")
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=1.5, labels="new-obs", pos=4, cex=.7, col="blue")
par(mfrow=c(2,2))
plot(lm.fit9_g)
par(mfrow=c(2,2))
plot(lm.fit10_g)
par(mfrow=c(2,2))
plot(lm.fit11_g)
set.seed(180122207)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
x1=c(x1 , 0.1)
x2=c(x2 , 1.5)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=1, labels="new-obs", pos=4, cex=.7, col="blue")
set.seed(180122207)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
x1=c(x1 , 0.1)
x2=c(x2 , 1)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=1, labels="new-obs", pos=4, cex=.7, col="blue")
set.seed(180122207)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
x1=c(x1 , 0.1)
x2=c(x2 , 1)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=1, labels="observação_nova", pos=4, cex=.7, col="red")
par(mfrow=c(2,2))
plot(lm.fit9_g)
par(mfrow=c(2,2))
plot(lm.fit10_g)
par(mfrow=c(2,2))
plot(lm.fit9_g)
set.seed(180122207)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
x1=c(x1 , 0.1)
x2=c(x2 , 1)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=1, labels="observação_nova", pos=4, cex=.7, col="red")
par(mfrow=c(2,2))
plot(lm.fit9_g)
par(mfrow=c(2,2))
plot(lm.fit10_g)
par(mfrow=c(2,2))
plot(lm.fit11_g)
identity()
identity(plot(lm.fit11_g))
set.seed(1) #180122207
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
x1=c(x1 , 0.1)
x2=c(x2 , 1)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=1, labels="observação_nova", pos=4, cex=.7, col="red")
par(mfrow=c(2,2))
plot(lm.fit9_g)
par(mfrow=c(2,2))
plot(lm.fit10_g)
par(mfrow=c(2,2))
plot(lm.fit11_g)
set.seed(180122207)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
x1=c(x1 , 0.1)
x2=c(x2 , 1)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=1, labels="observação_nova", pos=4, cex=.7, col="red")
par(mfrow=c(2,2))
plot(lm.fit9_g)
par(mfrow=c(2,2))
plot(lm.fit10_g)
par(mfrow=c(2,2))
plot(lm.fit11_g)
set.seed(1)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
x1=c(x1 , 0.1)
x2=c(x2 , 1)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=1, labels="observação_nova", pos=4, cex=.7, col="red")
par(mfrow=c(2,2))
plot(lm.fit9_g)
par(mfrow=c(2,2))
plot(lm.fit10_g)
par(mfrow=c(2,2))
plot(lm.fit11_g)
set.seed(180122207)
x1 = runif(100)
x2 = 0.5*x1+rnorm(100)/10
y = 2+2*x1+0.3*x2+rnorm(100)
x1=c(x1 , 0.1)
x2=c(x2 , 1)
y=c(y,6)
lm.fit9_g = lm(y~x1+x2)
lm.fit10_g = lm(y~x1)
lm.fit11_g = lm(y~x2)
plot(x1,x2)
text(x=0.1, y=1, labels="observação_nova", pos=4, cex=.7, col="red")
par(mfrow=c(2,2))
plot(lm.fit9_g)
par(mfrow=c(2,2))
plot(lm.fit10_g)
par(mfrow=c(2,2))
plot(lm.fit9_g)
par(mfrow=c(2,2))
plot(lm.fit10_g)
par(mfrow=c(2,2))
plot(lm.fit11_g)
par(mfrow=c(2,2))
plot(lm.fit9_g)
par(mfrow=c(2,2))
plot(lm.fit10_g)
par(mfrow=c(2,2))
plot(lm.fit11_g)
par(mfrow=c(2,2))
plot(lm.fit11_g)
